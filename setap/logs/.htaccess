# .htaccess - Carpeta /setap/logs/
# Proteccion maxima de archivos de log
# Codificacion UTF-8

# ===== PROTECCION ABSOLUTA DE LOGS =====
# Solo permitir acceso interno desde el servidor
<RequireAny>
    # Permitir acceso solo desde IPs autorizadas
    Require ip 127.0.0.1
    Require ip ::1
    Require ip 181.72.88.67
</RequireAny>

# ===== BLOQUEAR TODOS LOS ARCHIVOS DE LOG =====
<FilesMatch "\.(log|Logs|LOG|txt|TXT)$">
    <RequireAll>
        Require all denied
    </RequireAll>
</FilesMatch>

# ===== PERMITIR ACCESO DESDE SCRIPTS DE DEBUG =====
<Files "*.php">
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{HTTP_REFERER} /setap/debug/
        RewriteRule . - [L]
    </IfModule>
    <RequireAll>
        Require all granted
    </RequireAll>
</Files>

# ===== HEADERS DE SEGURIDAD =====
<IfModule mod_headers.c>
    Header always set X-Frame-Options DENY
    Header always set X-Content-Type-Options nosniff
    Header always set Cache-Control "no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
</IfModule>

# ===== BLOQUEAR METODOS PELIGROSOS =====
<LimitExcept GET POST>
    <RequireAll>
        Require all denied
    </RequireAll>
</LimitExcept>

# ===== EVITAR LISTADO DE DIRECTORIO =====
Options -Indexes

# ===== DESHABILITAR PHP EN LOGS =====
<FilesMatch "\.php$">
    <IfModule mod_php.c>
        php_flag engine Off
    </IfModule>
</FilesMatch>