# .htaccess para carpeta logs
# Renombra a .htaccess cuando subas al servidor

# ===== PROTECCION ABSOLUTA DE LOGS =====
# Solo permitir acceso interno desde el servidor
<RequireAll>
    Require ip 127.0.0.1
    Require ip ::1
    Require ip localhost
</RequireAll>

# ===== BLOQUEAR TODOS LOS ARCHIVOS DE LOG =====
<FilesMatch "\.(log|Logs|LOG)$">
    <RequireAll>
        Require all denied
    </RequireAll>
</FilesMatch>

# Bloquear archivos de texto que podrian contener logs
<FilesMatch "\.(txt|TXT)$">
    <RequireAll>
        Require all denied
    </RequireAll>
</FilesMatch>

# ===== CONFIGURACION ESPECIFICA PARA DEBUG =====
# Permitir acceso solo a scripts internos del debug
<Files "*.php">
    <RequireAll>
        # Permitir acceso desde el panel de debug
        RewriteEngine On
        RewriteCond %{HTTP_REFERER} /setap/debug/
        RewriteRule . - [L]
        
        # O permitir por IP especifica (tu IP)
        Require ip 181.72.88.67
        Require ip 127.0.0.1
    </RequireAll>
</Files>

# ===== HEADERS DE SEGURIDAD =====
Header always set X-Frame-Options DENY
Header always set X-Content-Type-Options nosniff
Header always set Cache-Control "no-cache, no-store, must-revalidate"
Header always set Pragma "no-cache"

# ===== BLOQUEAR METODOS PELIGROSOS =====
<RequireAll>
    <RequireMethod GET>
    <RequireMethod POST>
    <RequireAll>
</RequireAll>

# ===== EVITAR LISTADO DE DIRECTORIO =====
Options -Indexes

# ===== CONFIGURACION PHP PARA LOGS =====
# Deshabilitar ejecucion de PHP en directorio de logs
<FilesMatch "\.php$">
    <RequireAll>
        Require all denied
    </RequireAll>
</FilesMatch>