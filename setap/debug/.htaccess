# .htaccess - Carpeta /setap/debug/
# Configuracion para herramientas de debug
# Codificacion UTF-8
RewriteEngine On

<IfModule mod_env.c>
    SetEnvIf Remote_Addr ".*" CLIENT_IP=$0
</IfModule>

<IfModule mod_headers.c>
    Header set X-Debug-Client-IP "%{REMOTE_ADDR}e"
</IfModule>

# ===== RESTRICCIONES DE IP =====
<RequireAny>
    Require ip 127.0.0.1
    Require ip 0:0:0:0:0:0:0:1
    Require ip ::1/128
    Require ip 181.72.88.67
</RequireAny>

<IfModule mod_headers.c>
    Header always set X-Debug-Phase "AFTER-AUTH-SUCCESS"
</IfModule>

# Bloquear acceso si no cumple las IPs
ErrorDocument 403 "Acceso no autorizado al debug"

# ===== PROTECCION DE ARCHIVOS SENSIBLES =====
<FilesMatch "\.(env|log|ini|conf|config|bak|backup|old|txt)$">
    <RequireAll>
        Require all denied
    </RequireAll>
</FilesMatch>

# ===== HEADERS DE SEGURIDAD =====
<IfModule mod_headers.c>
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-Content-Type-Options nosniff
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Cache-Control "no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
    Header unset X-Powered-By
</IfModule>

# ===== CONFIGURACION PHP PARA DEBUG =====
<IfModule mod_php.c>
    php_flag display_errors On
    php_flag display_startup_errors On
    php_value error_reporting E_ALL
    php_value log_errors On
</IfModule>

# ===== EVITAR LISTADO DE DIRECTORIO =====
Options -Indexes